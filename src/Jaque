public class jaque {

    public static boolean hayJaque(casilla[][] casillas, String colorRey) {

        int reyFila = -1;
        int reyCol = -1;

        /* Localiza al rey de color indicado
        Recorre filas y columnas, busca la pieza R y la guarda en reyFila y reyCol
         */
        for (int f = 0; f < 8; f++) {
            for (int c = 0; c < 8; c++) {
                pieza p = casillas[f][c].getPieza();
                if (p != null &&
                        p.getTipo().equals("R") &&
                        p.getColor().equals(colorRey)) {

                    reyFila = f;
                    reyCol = c;
                }
            }
        }
        // rey no encontrado
        if (reyFila == -1) return false;

        // busca si alguna pieza contraria puede comerse al rey
        for (int f = 0; f < 8; f++) {
            for (int c = 0; c < 8; c++) {
                pieza p = casillas[f][c].getPieza();

                //si es color contrario al rey comprueba si seria posible la jugada
                if (p != null && !p.getColor().equals(colorRey)) {

                    boolean contraria = switch (p.getTipo()) {
                        case "T" -> MovimientoTorre.esValido(f, c, reyFila, reyCol);
                        case "A" -> MovimientoAlfil.esValido(f, c, reyFila, reyCol);
                        case "D" -> MovimientoReina.esValido(f, c, reyFila, reyCol);
                        case "C" -> MovimientoCaballo.esValido(f, c, reyFila, reyCol);
                        case "R" -> MovimientoRey.esValido(f, c, reyFila, reyCol);
                        case "P" -> esContrarioPeon(f, c, reyFila, reyCol, p.getColor());
                        default -> false;
                    };

                    if (contraria) return true;
                }
            }
        }

        return false;
    }

    //caso peon (ataqur en diagonal)
    private static boolean esContrarioPeon(int fi, int co, int fr, int cr, String color) {
        //si es blanco ataca hacia arriba (-1) si no lo es, hacia abajo (+1)
        int direccion = color.equals("B") ? -1 : 1;
        return fr == fi + direccion && Math.abs(cr - co) == 1;
    }
}
